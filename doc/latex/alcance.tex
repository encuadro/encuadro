\chapter{Alcance del proyecto}
\label{chap: alcance}
\section{Introducción}

En el presente capítulo se establece el alcance del proyecto. Se plantean los objetivos tal y como fueron formulados originalmente y luego se los clasifica en las tres partes fundamentales del proyecto: \textit{investigación}, \textit{implementación} y \textit{aplicación}. Estas son ponderadas en función de la importancia que tienen en el mismo, y por consiguiente la importancia que se les dio. Luego, se resume la estructura de la aplicación final, de manera de poder comprender a todo el proyecto en su conjunto. Finalmente se presenta un esquema del resto de la documentación donde se explican los elementos necesarios para desarrollar cada parte de dicha aplicación.
 
\section{Objetivos del proyecto}

El presente proyecto de fin de carrera tiene varios objetivos. En primer lugar se busca evaluar la capacidad de procesamiento de dispositivos móviles para aplicaciones de procesamiento de imágenes y estudiar el desempeño de diferentes algoritmos. Esto implica que se deben estudiar los diferentes dispositivos disponibles en el mercado. Por otro lado poder aplicar lo investigado para desarrollar una aplicación de realidad aumentada completa funcionando sobre un dispositivo móvil y en tiempo real. Finalmente se quiere utilizar dicha aplicación para abordar un problema real, el \textit{recorrido interactivo con realidad aumentada} para museos.

Los objetivos anteriores pueden resumirse en las tres tareas fundamentales del proyecto, que se expresan a continuación:

\begin{itemize}
\item[1.] \textbf{Investigación:} Comprensión de la arquitectura de las plataformas móviles y de sus plataformas de desarrollo, con el objetivo de implementar los distintos algoritmos y \textit{software} en general en las mismas. Estudio de las diferentes maneras de lograr la realidad aumentada, elección de los algoritmos a utilizar y su comprensión, desarrollo de nuevos algoritmos y variantes de algoritmos existentes. Aprendizaje de herramientas en general.
\item[2.] \textbf{Implementación}: Integración de los distintos bloques para lograr la realidad aumentada. Implementación de bloques lógicos accesorios que faciliten la integración de los primeros. Validación de los algoritmos utilizados y desarrollados.
\item[3.] \textbf{Aplicación}: Implementación de una aplicación completa en la que el usuario ingrese al museo, se ubique dentro de él, se dirija a un cuadro, reciba información respecto del mismo y finalmente experimente la realidad aumentada sobre la obra.
\end{itemize}

Cada una de ellas se jerarquizó en función de la importancia que se les dio en el proyecto, así como también el tiempo que se les dedicó:

$$
\begin{array}{|c|c|} \hline
\textbf{Frente de trabajo}			& \textbf{Porcentaje} \\ \hline
\small \textbf{Investigación}		&	50\% \\ \hline
\small \textbf{Implementación}	& 30\% \\ \hline
\small \textbf{Aplicación}			& 20\%  \\ \hline
\end{array}
$$

Lo que la tabla anterior intenta reflejar es que el foco principal del proyecto es la investigación, evaluación de algoritmos y su migración a plataformas móviles. La aplicación es un objetivo secundario que ayuda a validar los conceptos estudiados en las etapas de investigación e implementación. 

\section{Estado del arte}
Para llevar a cabo los objetivos planteados es bueno tener un contexto del estado del arte en cuanto al desarrollo de aplicaciones de realidad aumentada. Existen en la actualidad m\'ultiples kits de desarrollo comerciales para aplicaciones de realidad aumentada, en los que de manera sencilla, se logran este tipo de aplicaciones con desempe\~nos  muy buenos. Tal es el caso de \textit{Metaio} \cite{metaio12}, \textit{Vuforia} \cite{vuforia12}, \textit{String} \cite{string12} y \textit{Aurasma} \cite{aurasma12}. Por su parte, \textit{Layar} \cite{layar12}, es tambi\'en un kit de desarrollo para aplicaciones de realidad aumentada, pero se especializa en el agregado de contenido digital s\'olo sobre páginas impresas como revistas y catálogos. Ninguna de las herramientas anteriores es gratuita y tampoco \textit{open source}. En la Figura \ref{fig: metaioystring} se muestra un ejemplo que incluye por defecto \textit{Metaio} y otro que incluye \textit{String}.

\begin{figure}[H]
\centering
$$
\begin{array}{cc}
\includegraphics[scale=0.222]{figs_alcance/metaio.png} & \includegraphics[scale=0.5]{figs_alcance/string.png}
\end{array}
$$
\caption{Izq.: Ejemplo de realidad aumentada que incluye por defecto el kit de desarrollo \textit{Metaio}. Der.: Otro ejemplo de realidad aumentada incluído por \textit{String}. En ambos casos debe notarse la coherencia lograda entre el mundo real y el mundo virtual. En la imagen de la derecha se tiene al personaje de \textit{String} parado en una mesa por delante de un mate y encima de un llavero.}
\label{fig: metaioystring}
\end{figure}

Si bien se probaron algunas de estas herramientas y se tomaron de ellas est\'andares en cuanto a la \textit{performance} que una aplicaci\'on de realidad aumentada debe tener, \textbf{no es un objetivo} del proyecto el desarrollo de aplicaciones de realidad aumentada con kits de desarrollo ya existentes. Se hace hincapi\'e en la investigaci\'on de herramientas y adquisici\'on de experiencia propia, con el objetivo de marcar una hoja de ruta para todo aquel que desee continuar la investigaci\'on con nuevas ideas y algoritmos. Todo el código generado en este proyecto, así como la documentación es \textit{open source} y se puede bajar del repositorio git ubicado en: \url{https://github.com/encuadro/encuadro}.
%Se deja a disposici\'on de cualquier interesado el c\'odigo de la aplicaci\'on final, los algoritmos implementados o editados, as\'i como toda la documentaci\'on.

Un último aspecto a destacar es que dentro del IIE hay poca experiencia en el área de realidad aumentada y en particular es la primera experiencia en plataformas móviles, por lo cual este proyecto tiene la importancia además de abrir el camino a nuevas generaciones que quieran abordar estos temas. 

\section{Explicación global de la aplicación}
\label{sec: app}
Si bien se dijo que la creación de la aplicación integral, correspondiente a un recorrido con realidad aumentada para muesos, corresponde tan sólo a un quinto del alcance total del proyecto; la visualización de la aplicación total es quizá la forma más sencilla de comprender el proyecto en su conjunto y ayuda a evaluar si el sistema desarrollado funciona de manera aceptable.\\

La aplicación se desglosa en tres grandes bloques que son resumidos individualmente en secciones subsiguientes:
\begin{itemize}
\item \textbf{Navegación}
\item \textbf{Identificación de obras}
\item \textbf{Realidad aumentada}
\end{itemize}

\subsection{Navegación}
La navegación es la ubicación del usuario dentro del museo, la importancia de este bloque reside en que permite brindar información contextual de donde se encuentra el usuario. Esta información podría ser una breve descripción de la sala en la que se encuentra o indicaciones para ir de un lugar a otro del museo, entre otras. Desde el punto de vista de la aplicación también es importante porque permite manejar un menor volumen de datos al momento de identificar las obras, debido a que sabe en que sala se encuentra el usuario.  Se estudiaron distintas alternativas para la navegación. La primera posibilidad analizada fue la utilización de tres o más \textit{access points}, mediante los cuales, una vez mapeadas las características de las se\~nales en cada uno de los puntos de las salas, se puede ubicar al usuario dentro de las mismas. Otra forma de navegación que se tuvo en cuenta fue la localización a través de la tecnología GPS. Sin embargo, se optó por utilizar códigos QR dada su amplia difusión, practicidad y facilidad de implementación. La discusión técnica que justifica estas elecciones se ve en el Capítulo \ref{chap: navident}.\\

\subsection{Identificación de obras}
Por identificación de obras se entiende al proceso mediante el cual la aplicación detecta frente a qué obra se encuentra el usuario para así entonces brindarle información de la misma, una audioguía y si fuera el caso la posibilidad de desplegar realidad aumentada sobre ella. La forma en la que se implementó este bloque fue mediante un algoritmo de detección de características de imágenes llamado SIFT. Es un algoritmo que se basa en el contenido de la imagen únicamente, por lo que para identificar la obra no se necesita ningún tipo de marcador o agregado externo. Se verá en profundidad en el Capítulo \ref{chap: navident}.\\

\subsection{Realidad Aumentada}

El proceso mediante el cual se logra la realidad aumentada puede verse en el diagrama de bloques de la Figura \ref{fig: bloques_ra}. 

\begin{figure}[h!]
\centering
\includegraphics[scale=1.2]{figs_alcance/bloques_ra.eps}
\caption{Diagrama de bloques del proceso mediante el cual se logra la realidad aumentada.}
\label{fig: bloques_ra}
\end{figure}

El primer bloque corresponde a la cámara que captura una imagen. En el segundo bloque dicha imagen es procesada con el objetivo de detectar en esta características. Estas características pueden ser segmentos, esquinas, descriptores. El tercer bloque corresponde a la estimación de pose, busca estimar en qué posición se encuentra la cámara respecto de cierto eje de coordenadas previamente definido y hacia dónde esta apunta.  En el cuarto bloque con la información anterior, se debe poder \textit{renderizar} una escena de manera consistente con la pose de la cámara, para así entonces lograr la salida del sistema, que será una imagen con la realidad aumentada incorporada.

Debe notarse que en ninguna etapa se mencionó ningún algoritmo en particular, ya sea para la detección de características como para la estimación de pose. Tampoco se menciona nada en particular para la etapa de rendereo. Esto se debe a que las etapas se concibieron de forma genérica, de manera ser libres de utilizar cualquier algoritmo de detección de características con cualquier algoritmo de estimación de pose. Las interfases entre los bloque están pensadas de forma de poder cambiar un bloque sin generar problemas en los demás bloques.  \\

Para este proyecto se dise\~nó un marcador formado por tres grupos de cuadrados concéntricos, a partir del cual se extraen los segmentos necesarios para la estimación de la pose del dispositivo. El bloque de detección de características está compuesto por los bloques del diagrama de la Figura \ref{fig: bloques_correspondencias}.\\
\begin{figure}[h!]
\centering
\includegraphics[scale=1.2]{figs_alcance/bloques_correspondencias.eps}
\caption{Diagrama de bloques de la detección de características utilizada en este proyecto.}
\label{fig: bloques_correspondencias}
\end{figure}

En el diagrama de bloques de la Figura \ref{fig: bloques_correspondencias}, primero se detectan idealmente todos los segmentos que hay en la imagen y luego se filtran tan sólo los pertenecientes al marcador antedicho y se agrupan por cuadrado. En el tercer bloque, se hallan las esquinas de estos cuadrados mediante la intersección de los segmentos. Finalmente estos puntos son ordenados de una manera predefinida. Detalles respecto de este proceso y sobre el marcador utilizado se ven en el Capítulo \ref{ch:marcadores}.\\

\section{Sobre el documento}

En lo que resta del documento se verán en detalle todos los aspectos técnicos referidos a los temas vistos en este capítulo. Se explica claramente la investigación realizada, los algoritmos utilizados, las herramientas aprendidas y en general, toda la experiencia adquirida a lo largo del proyecto. Se justifican claramente todas las decisiones que hubo que tomar y se comentará además, en cada caso, si estas fueron acertadas o no.\\

En el Capítulo \ref{chap: hwysw} se comparan las plataformas móviles disponibles y se justifica la elección de una de ellas. Luego se ven más a fondo algunas características de la plataforma seleccionada y finalmente algunas herramientas genéricas requeridas para el desarrollo. En el Capítulo \ref{chap: navident} se ven en detalle las soluciones técnicas para la navegación y la detección de la obra. El Capítulo \ref{ch:detection} abarca los temas detección de características de las imágenes en general y se muestran ejemplos de interés para la aplicación final. Por otro lado en el Capítulo \ref{ch:marcadores} se comentan detalles respecto de marcadores comúnmente utilizados en aplicaciones de realidad aumentada y se propone un diseño particular de marcador utilizado en este proyecto. Adicionalmente se desarrollan los algoritmos utilizado para la detección de este marcador basado en Detector de Segmentos de Línea: LSD.\\

Más adelante, en el Capítulo \ref{chap: lsd}, se estudia a fondo el algoritmo de detección de segmentos en imágenes digitales llamado LSD, utilizado para la detección de segmentos representada en el primer bloque de la Figura \ref{fig: bloques_correspondencias} junto con resultados de la optimización para tiempo real realizada sobre el mismo. Luego, en el Capítulo \ref{chap: camypose}, se plantea un modelo para la cámara utilizada para la captura y se introducen conceptos básicos para comprender cómo es el proceso de la estimación de la pose de la misma. El algoritmo utilizado en este proyecto para tal fin, POSIT ,se presenta en el Capítulo \ref{chap: posit}.\\

El Capítulo \ref{chap: kalman} presenta el filtro de \textit{Kalman} y sus ecuaciones básicas. En el Capítulo \ref{chap: render} se introduce brevemente el concepto de \textit{render} y se presenta la herramienta utilizada para realizar \textit{renders} en la plataforma escogida. Luego, en el Capítulo \ref{chap: casoUso}, se presentan los distintos casos de uso implementados para probar integrar todos los bloques necesarios para la realidad aumentada en peque\~nas aplicaciones individuales. Más adelate, en el Capítulo \ref{chap: imp}, se explican los detalles técnicos respecto de la aplicación completa, tal y como se define en la Sección \ref{sec: app}.\\

Las herramientas utilizadas para analizar el desempe\~no y la validación de cada algoritmo se explican en el Anexo \ref{chap: benchmark}. Finalmente, en el Anexo \ref{chap: costos}, se analizan los costos económicos que tuvo el proyecto.